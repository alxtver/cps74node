<h1>ПКИ</h1>
<button class="btn btn-dark" style="margin-bottom: 1rem" onclick="location.href='/add';">Добавить ПКИ</button>

<form name="search_form" action="/pkis" method="post">
  <div class="form-row align-items-center">
    <div class="col-auto">      
      <div class="input-group mb-2">
        <input type="text" name="search" class="form-control hoverable" id="search" placeholder="Поиск...">
      </div>
    </div>
  </div>
</form>

{{#if pkis.length}}

<table class="table table-sm table-bordered table-hover">
  <thead class="thead-dark">
    <tr>
        <th>Тип</th>
        <th>Производитель</th>
        <th>Модель</th>
        <th>Серийный номер</th>
        <th>Страна производства</th>
        <th>Партия</th>
        <th>Номер машины</th>
        <th>В СБ</th>
        <th></th>
    </tr>
  </thead>
  <tbody>
{{#each pkis}}
  <tr>
    <td>{{type_pki}}</td>
    <td>{{vendor}}</td>
    <td>{{model}}</td>
    <td>{{serial_number}}</td>
    <td>{{country}}</td>
    <td>{{part}}</td>
    <td>{{number_machine}}</td>
    <td>{{in_case}}</td>
    <td class="td_btn">
        <button class="btn_f" onclick="location.href='/pkis/{{id}}/edit?allow=true';"><i class="fa fa-pencil"></i></button>
        <button class="btn_d" onclick="location.href='/pkis/{{id}}/del?allow=true';"><i class="fa fa-trash"></i></button>
    </td>
  </tr>
{{/each}}
</tbody>
</table>

{{else}}
<p>Нет ни одного ПКИ</p>
{{/if}}

<h1>Quote: {{search}} </h1>

<script> 
        document.getElementById("search").addEventListener("keyup", function (e) {
             e.preventDefault();
            // получаем данные формы
            let search_form = document.forms["search_form"];
            let search = search_form.elements["search"].value;

            // сериализуем данные в json
            let searchJSON = JSON.stringify({search: search});
            let request = new XMLHttpRequest();
            // посылаем запрос на адрес "/user"
             request.open("POST", "/pkis/user", true);   
             request.setRequestHeader("Content-Type", "application/json");
             request.addEventListener("load", function () {
                // получаем и парсим ответ сервера
                 let receivedsearch = JSON.parse(request.response);
                 console.log(receivedsearch.search);   // смотрим ответ сервера
             });
             request.send(searchJSON);
             success: function a(data){ 
                    console.log('data');
                    $('#userView').text(data); //Отправка данных в div на странице
                   }
         });
         
    </script>
</body>